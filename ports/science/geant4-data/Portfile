# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0

name                geant4-data
version             1.0
categories          science
platforms           darwin
license             Geant4
maintainers         mojca openmaintainer
description         Data files for Geant4
long_description    ${description}
homepage            http://geant4.web.cern.ch/
master_sites        http://geant4.cern.ch/support/source/
supported_archs     noarch

# this variable should be set in geant4 PortGroup
set geant.datadir ${prefix}/share/Geant4/Data

set geant.data_versions {
    G4NDL              4.3   55493e74cba90e6cb167a5008e138cd7  G4NDL               G4NDL              d7559295e71e373246f90db9ab8ce652a1bb71c2  169dbc6d6c1c5b7bb57ee676687ae5b830847cf4e75fecb1e35187172f472e6a
    G4NDL              4.2   2302d7ffeef1a450955302f027ee1cf4  G4NDL               G4NDL              5289896235ccb84f551f642447372f286084a695  173f60a506b9176d7ff531d6a5f6195dcec74df30ffafc09644f47f979bd641b
    G4NDL              4.0   6d23aff98e5706af1dd7fff397969f37  G4NDL               G4NDL              602d209009ee93d792cb67fe592aa37de6bab7c2  cef4fab143d8dcb8eae4c6e5c095af01d735bb36334b9958e00e30bcec9827ed
    G4EMLOW            6.33  0002a1c16c9b1fb5e8d49dfbce12a576  G4EMLOW             G4EMLOW            e6b3b60c04d6e5faa6ea9d9f04c805fd479dbc47  441542ed5359b536f7908369d4abc045468a14e89975855dd145ffd352d3701f
    G4EMLOW            6.32  9d3302072ba694b1d4505c330ed89d89  G4EMLOW             G4EMLOW            d5b1c435fb4925339175188472f1453637c98b0d  bdb3c00af89b18c21553d79fd823110429fdcf1e83c029aa450185d9caf4a7cf
    G4EMLOW            6.23  98cdca1024bf168c8f8ca1deb40f43b9  G4EMLOW             G4EMLOW            84529979894ed5e35ade27201fee67884d7b381d  6452215d9a0acbd35c71eed47f3581fd0276d7088b1a1a8588c003d9072aed3e
    PhotonEvaporation  2.3   08848ebdd536280a0629d802040b70be  G4PhotonEvaporation PhotonEvaporation  8cd383005f5f8c38f69e4818cf5b1ad397925abc  60449df933794aa0ad3938886c8c023e3093ff59ad6c752923390d5c550f34cb
    PhotonEvaporation  2.2   8010e7ce8a92564e38dd3418e6040563  G4PhotonEvaporation PhotonEvaporation  8efc16c40b4755d209f83f31f2d251bbef52ccb8  9db02ef8e5b065c1b7f7d1becd1b72dde2b8fc617bcedde97788040418f239c0
    RadioactiveDecay   3.7   039e5f64b0e451eb5c095bf81552cb42  G4RadioactiveDecay  RadioactiveDecay   a30e4c0123242405219da4194f37653719a53cbc  f0b96a5f39fb58c1fff80140b4b471fee9718e96d01660bc1d6bff85e0ceab53
    RadioactiveDecay   3.6   9566ff1614bea7455343328cb66abd6f  G4RadioactiveDecay  RadioactiveDecay   1ed4a9707a18720d9a649fd4a7ca97faf24434b9  3502ed4be04d694115a3acf59d7a3593725a2d79f3adad0ffa135ff653f89d1d
    RadioactiveDecay   3.4   a5b681048584631608ab0965b33c7959  G4RadioactiveDecay  RadioactiveDecay   378c237cd5857b4205980815a3c47cdb654506d4  1ecfb477ca3c3966dd128193d8e11e24d6c3dc29cc188c8c9b0b21b941f9c30c
    G4ABLA             3.0   d7049166ef74a592cb97df0ed4b757bd  G4ABLA              G4ABLA             656b10fc9d8022e89e99a728576d0b502161aa69  99fd4dcc9b4949778f14ed8364088e45fa4ff3148b3ea36f9f3103241d277014
    G4NEUTRONXS        1.3   ede7c4b3e99cbe1773b672a7404fe0f6  G4NEUTRONXS         G4NEUTRONXS        33ed98449ad754cfd756247392d5484aca8a276b  0aad03ecaf3762e38d9cede48366615d694544c3a1fd843141c548a9a128028f
    G4NEUTRONXS        1.2   092634b9258c7bc387cb83557ff1df81  G4NEUTRONXS         G4NEUTRONXS        5ebf3b9006a9c6249cad8e40e9661fbe3ec50f0e  9ce488505b4c3623e2d98209f708a30e3f213a1371a9110d289257a02b2d7d5c
    G4NEUTRONXS        1.1   61ef3a05b56525db04e11820e3f603f1  G4NEUTRONXS         G4NEUTRONXS        a4cd8791219f0df856da39295e7f913a537bde1a  d477a377aee229bf9d75d3c9cc4b7cd48b414285a246449e4e44a72bf037472b
    G4PII              1.3   05f2471dbcdf1a2b17cbff84e8e83b37  G4PII               G4PII              313a2615903b0682b8aabc344bedde82c345704b  6225ad902675f4381c98c6ba25fc5a06ce87549aa979634d3d03491d6616e926
    RealSurface        1.0   0dde95e00fcd3bcd745804f870bb6884  RealSurface         RealSurface        030513fe340e0cccbfe0b9ae9acb3ba6b5291ebb  3e2d2506600d2780ed903f1f2681962e208039329347c58ba1916740679020b1
    G4SAIDDATA         1.1   d88a31218fdf28455e5c5a3609f7216f  G4SAIDDATA          G4SAIDDATA         7f0c75c86eea3d227379d3dfe77e4600752f99a2  a38cd9a83db62311922850fe609ecd250d36adf264a88e88c82ba82b7da0ed7f
}

foreach {data.name data.version data.md5 data.filename data.distname data.rmd160 data.sha256} ${geant.data_versions} {
    subport ${name}-${data.name}-${data.version} {

        version             ${data.version}
        description         ${data.name} v${data.version} data files for Geant4
        long_description    ${description}
        distfiles           ${data.filename}.${data.version}${extract.suffix}
        checksums           md5 ${data.md5} rmd160 ${data.rmd160} sha256 ${data.sha256}
        distname            ${data.distname}${data.version}
        # a patch for wrong file permissions (6.23 is for 9.5, 6.32 is for 9.6)
        post-extract {
            if {$subport == "${name}-G4EMLOW-6.23" || $subport == "${name}-G4EMLOW-6.32"} {
                # these files don't have sufficient permissions, but others have 755
                # /penelope/pdatconf.p08
                # /penelope/rayleigh/*
                system "find ${workpath}/${distname} -type f -exec chmod 644 {} \\;"
                # alternatively G4EMLOW-6.32 can be fetched from G4EMLOW.6.32_permissions.tar.gz
                # the following files could also be fixed: G4NEUTRONXS 1.1/1.2/1.3, PhotonEvaporation 2.2
            }
        }
        use_configure       no
        build               {}
        destroot {
            xinstall -m 755 -d ${destroot}${geant.datadir}
            move ${workpath}/${distname} ${destroot}${geant.datadir}
        }
    }
}

if {$subport == $name || $subport == ""} {
    fetch {}
    checksum {}
    extract {}
    patch {}
    use_configure       no
    build {}
    destroot {
        set geant.docdir ${prefix}/share/doc/${name}
        xinstall -m 755 -d ${destroot}${geant.docdir}
        system "echo $name is a stub port > ${destroot}${geant.docdir}/README"
    }
    livecheck.type  none
}
